<include file="Public:header"/>
<script type="text/javascript">
var UEURL = '__ROOT__/Public/Plugin/umeditor/';
</script>
<link href="__PUBLIC__/Plugin/umeditor/themes/default/css/umeditor.css" type="text/css" rel="stylesheet">
<script type="text/javascript" src="__PUBLIC__/Plugin/umeditor/third-party/jquery.min.js"></script>
<script type="text/javascript" charset="utf-8" src="__PUBLIC__/Plugin/umeditor/umeditor.config.js"></script>
<script type="text/javascript" charset="utf-8" src="__PUBLIC__/Plugin/umeditor/umeditor.min.js"></script>
<script type="text/javascript" src="__PUBLIC__/Plugin/umeditor/lang/zh-cn/zh-cn.js"></script>

<div class="col-sm-12 widget-container-span">
	<div class="widget-box transparent">
		<div class="widget-header">
			<div class="widget-toolbar no-border">
				<ul class="nav nav-tabs" id="myTab">
					<li class="active"><a data-toggle="tab" href="#home1">酒店管理</a></li>
					<li><a data-toggle="tab" href="#home2">添加/修改酒店</a></li>
				</ul>
			</div>
		</div>

		<div class="widget-body">
			<div class="widget-main padding-12 no-padding-left no-padding-right">
				<div class="tab-content padding-4">
					<div id="home1" class="tab-pane in active">
						<div class="row">
							<div class="col-xs-12 no-padding-right">
								<div class="table-responsive">
									<table id="sample-table-1"
										class="table table-striped table-bordered table-hover">
										<thead>
											<tr>
												<th class="center"><label> <input
														type="checkbox" class="ace"> <span class="lbl"></span>
												</label></th>
												<th>ID</th>
												<th>酒店名称</th>
												<th>酒店地址</th>
												<th>酒店星级</th>
												<th>所属地域</th>
												<th>操作</th>
											</tr>
										</thead>

										<tbody>
										<volist name="result" id="result">
											<tr>
												<td class="center"><label> <input
														type="checkbox" class="ace"> <span class="lbl"></span>
												</label></td>
												<td>{$result.id}</td>
												<td>{$result.name}</td>
												<td>{$result.address}</td>
												<td>{$result.levelname}</td>
												<td>{$result.cityname}</td>
												<td style="display:none" >{$result.summary}</td>
												<td style="display:none" >{$result.D_price}</td>
												<td style="display:none" >{$result.T_price}</td>
												<td style="display:none" >{$result.S_price}</td>
												<td style="display:none" >{$result.F_flg}</td>
												<td style="display:none" >{$result.L_flg}</td>
												<td style="display:none" >{$result.B_flg}</td>
												<td style="display:none" >{$result.level}</td>
												<td style="display:none" >{$result.city_id}</td>
												<td><a href="javascript:void(0);" onclick="reProduct(this);" class="btn btn-white btn-sm">修改</a><a class="J_ajax_del btn btn-white btn-sm" href="{:U('Admin/Product/delproduct',array('unitid'=>$result['id'],'productid'=>$result['productid'],'cityid'=>$result['cityid']))}">删除</a></td>
											</tr>
										</volist>
										</tbody>
									</table>
									<div class="pagination" style="margin:0px;">
									    {$page}
									</div>
								</div>
							</div>
						</div>
					</div>
					
					<div id="home2" class="tab-pane in">
						<form class="form-horizontal J_ajaxForm" enctype="multipart/form-data" id="myform" action="{:U('Admin/Hotel/addHotel')}" method="post">
							<div class="tabbable">
								<div class="tab-content">
									<div class="tab-pane active">
										<table width="100%">
											<tbody>
												<tr>
													<td>都道府县:</td>
													<td><select class="select_2" name="city">
															<option value="0">选择地域</option>
															<volist name="city" id="addmenu">
															<option value="{$addmenu.id}">{$addmenu.name}</option>
															</volist>
													</select></td>
												</tr>
												<tr>
													<td>酒店星级:</td>
													<td><select class="select_2" name="level">
														<option value="">选择星级</option>
														<option value="0">三星</option>
														<option value="1">四星</option>
														<option value="2">五星</option>
													</select></td>												
												</tr>
												<tr>
													<td>酒店名称:</td>
													<td><input type="text" class="input col-sm-6" name="name" value=""></td>
													<td style="display:none"><input type="text" name="hotel_id" value=""></td>
												</tr>
												<tr>
													<td>酒店地址:</td>
													<td><input type="text" class="input col-sm-6" name="address" value=""></td>												
												</tr>
												<tr>
													<td>酒店福利:</td>
													<td>
														<table id='unittable' width="60%" >
															<tr>										
																<td align="right">早餐：</td>
																<td align="right"><input type="checkbox" class="tdInput" id="B_flg" name="B_flg" value="1"></td>
																<td align="right">午餐：</td>
																<td align="right"><input type="checkbox" class="tdInput" id="L_flg" name="L_flg" value="1"></td>
																<td align="right">晚餐：</td>
																<td align="right"><input type="checkbox" class="tdInput" id="S_flg" name="S_flg" value="1"></td>
															</tr>
														</table>
													</td>											
												</tr>
												<tr>
													<td>房间价格:</td>
													<td>
														<table id='unittable' width="60%" >
															<tr>										
																<td align="right">S房价：</td>
																<td align="right"><input type="text" class="tdInput" id="S_price" name="S_price" value=""></td>
																<td align="right">T房价：</td>
																<td align="right"><input type="text" class="tdInput" id="T_price" name="T_price" value=""></td>
																<td align="right">D房价：</td>
																<td align="right"><input type="text" class="tdInput" id="D_price" name="D_price" value=""></td>
															</tr>
														</table>
													</td>											
												</tr>
												<tr>
													<td>酒店简介:</td>
													<td><!--style给定宽度可以影响编辑器的最终宽度-->
														<div type="text/plain" id="myEditor" style="width:660px;height:240px;">
														</div>
													</td>
												</tr>
											</tbody>
										</table>
									</div>
								</div>
							</div>
							<div class="form-actions">
								<button class="btn btn-primary btn_submit J_ajax_submit_btn" type="submit">提交</button>
								<a class="btn" href="">返回</a>
							</div>
						</form>
					</div>
				</div>
			</div>
		</div>
		
		<script type="text/javascript">
			var flag = true;
			function reProduct(o) {
				var cityid = $(o).parent().prev().html();
				var level = $(o).parent().prev().prev().html();
				var B_flg = $(o).parent().prev().prev().prev().html();
				var L_flg = $(o).parent().prev().prev().prev().prev().html();
				var F_flg = $(o).parent().prev().prev().prev().prev().prev().html();
				var S_price = $(o).parent().prev().prev().prev().prev().prev().prev().html();
				var T_price = $(o).parent().prev().prev().prev().prev().prev().prev().prev().html();
				var D_price = $(o).parent().prev().prev().prev().prev().prev().prev().prev().prev().html();
				var info = $(o).parent().prev().prev().prev().prev().prev().prev().prev().prev().prev().html();
				var name = $(o).parent().prev().prev().prev().prev().prev().prev().prev().prev().prev().prev().prev().prev().prev().html();
				var id = $(o).parent().prev().prev().prev().prev().prev().prev().prev().prev().prev().prev().prev().prev().prev().prev().html();
				var address = $(o).parent().prev().prev().prev().prev().prev().prev().prev().prev().prev().prev().prev().prev().html();
								
				$('select[name="city"]').val(cityid);
				$('select[name="level"]').val(level);
				$('input[name="name"]').val(name);
				$('input[name="hotel_id"]').val(id);
				$('input[name="address"]').val(address);
				if ( B_flg == "1" ) {
					 document.getElementById("B_flg").checked = true;
				}
				if ( F_flg == "1" ) {
					 document.getElementById("F_flg").checked = true;
				}
				if ( S_flg == "1" ) {
					 document.getElementById("S_flg").checked = true;
				}
				$('input[name="S_price"]').val(S_price);
				$('input[name="T_price"]').val(T_price);
				$('input[name="D_price"]').val(D_price);
				$('#myEditor').html(info);

				$('#myTab li').removeClass("active");
				$('#myTab li').eq(1).addClass("active");
				$('#home1').removeClass("active");
				$('#home2').addClass("active");
			}
		    
		</script>
		<script type="text/javascript">
	    //实例化编辑器
	    var um = UM.getEditor('myEditor');
	    um.addListener('blur',function(){
	        $('#focush2').html('编辑器失去焦点了')
	    });
	    um.addListener('focus',function(){
	        $('#focush2').html('')
	    });
	</script>
	</div>
</div>