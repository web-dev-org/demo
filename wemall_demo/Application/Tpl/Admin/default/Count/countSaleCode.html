<include file="Public:header"/>
<style media="print" type="text/css">
     .Noprint
     {
         display: none;
     }
 </style>
<div class="col-sm-12 widget-container-span">
	<div class="widget-box transparent">
		<div class="widget-header">
			<div class="widget-toolbar no-border">
				<ul class="nav nav-tabs" id="myTab">
					<li class="active"><a data-toggle="tab" href="#home1">订单数据统计</a></li>
				</ul>
			</div>
		</div>
		<div class="widget-body">
			<div class="widget-main padding-12 no-padding-left no-padding-right">
				<div class="tab-content padding-4">
					<div id="home1" class="tab-pane in active">
						<div class="row">
							<div class="col-xs-12 no-padding-right">
								<div class="table-responsive">
									<table id="sample-table-1"
										class="table table-striped table-bordered table-hover">
										<thead>
											<tr>
												<div style="margin-bottom:10px">
												期间开始日：<input type="date" class="input" style="width:150px;" id="startTime" name="startTime" value="{$startTime}">
												期间结束日：<input type="date" class="input" style="width:150px;" id="endTime" name="endTime" value="{$endTime}">
												<button class="btn btn-primary" style="height:30px;font-size: 10px;padding: 1px 10px;" onclick="searchOrder()" >统计</button>
<!-- 												<button class="btn btn-primary" style="height:30px;font-size: 10px;padding: 1px 10px;" onclick="outExcel()" >文件下载</button>
 -->												</div>
											</tr>
										</thead>

										<tbody>
											<th>业务员</th>
											<th>业务Code</th>
											<th>用户数</th>
											<th>下单用户数</th>
											<th>订单转化率</th>
											<th>订单金额</th>
											<th>订单量</th>
											<th>客单价</th>
											<volist name="result" id="pro">
												<tr>
													<td>{$pro.name}</td>
													<td>{$pro.salesCode}</td>
													<td>{$pro.totalMember}</td>
													<td>{$pro.orderMember}</td>
													<td>{$pro.orderFee}</td>
													<td>{$pro.totalAmt}</td>
													<td>{$pro.orderCount}</td>
													<td>{$pro.perPrice}</td>
												</tr>
											</volist>
										</tbody>
									</table>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		
		<script type="text/javascript">
		
			function searchOrder() {
				var startTime = $('input[name="startTime"]').val();
				var endTime = $('input[name="endTime"]').val();
				
				if ( startTime.length == 0 ) {
					alert("开始时间未填写！");
					return;
				}
				if ( endTime.length == 0 ) {
					alert("结束时间未填写！");
					return;
				}
				
				var d1 = new Date(startTime.replace(/\-/g, "\/"));  
				var d2 = new Date(endTime.replace(/\-/g, "\/"));
				
				if ( d1 > d2 ) {
					alert("开始时间不能大于结束时间！");
					return;
				}

				
				post("{:U('Admin/Count/countSaleCode')}", {startTime:startTime,endTime:endTime});
			}
			
			function outExcel(){
				var startTime = $('input[name="startTime"]').val();
				var endTime = $('input[name="endTime"]').val();
				
				if ( startTime.length == 0 ) {
					alert("开始时间未填写！");
					return;
				}
				if ( endTime.length == 0 ) {
					alert("结束时间未填写！");
					return;
				}
				
				var d1 = new Date(startTime.replace(/\-/g, "\/"));  
				var d2 = new Date(endTime.replace(/\-/g, "\/"));
				
				if ( d1 >= d2 ) {
					alert("开始时间不能大于结束时间！");
					return;
				}
				
				post("{:U('Admin/Count/outExcel')}", {startTime:startTime,endTime:endTime});
				
			}
			
			
			function post(URL, PARAMS) {        
			    var temp = document.createElement("form");        
			    temp.action = URL;        
			    temp.method = "post";        
			    temp.style.display = "none";        
			    for (var x in PARAMS) {        
			        var opt = document.createElement("textarea");        
			        opt.name = x;        
			        opt.value = PARAMS[x];            
			        temp.appendChild(opt);        
			    }        
			    document.body.appendChild(temp);        
			    temp.submit();        
			    return temp;        
			} 
		</script>
	</div>
</div>